{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { App, SharedEventEmitter, ModuleBase } from 'expo-firebase-app';\n\nimport DynamicLink from './DynamicLink';\n\nconst NATIVE_EVENTS = {\n  linksLinkReceived: 'Expo.Firebase.links_link_received',\n};\n\nexport const MODULE_NAME = 'ExpoFirebaseLinks';\nexport const NAMESPACE = 'links';\n\nexport const statics = {\n  DynamicLink,\n};\n\n/**\n * @class Links\n */\nexport default class Links extends ModuleBase {\n  static moduleName = MODULE_NAME;\n  static namespace = NAMESPACE;\n  static statics = statics;\n\n  constructor(app: App) {\n    super(app, {\n      events: Object.values(NATIVE_EVENTS),\n      moduleName: MODULE_NAME,\n      hasMultiAppSupport: false,\n      hasCustomUrlSupport: false,\n      namespace: NAMESPACE,\n    });\n\n    SharedEventEmitter.addListener(\n      // sub to internal native event - this fans out to\n      // public event name: onMessage\n      NATIVE_EVENTS.linksLinkReceived,\n      ({ link }) => {\n        SharedEventEmitter.emit('onLink', link);\n      }\n    );\n\n    // Tell the native module that we're ready to receive events\n    if (this.nativeModule.jsInitialised) {\n      this.nativeModule.jsInitialised();\n    }\n  }\n\n  /**\n   * Create long Dynamic Link from parameters\n   * @param parameters\n   * @returns {Promise.<String>}\n   */\n  async createDynamicLink(link: DynamicLink): Promise<string> {\n    if (!(link instanceof DynamicLink)) {\n      throw new Error(\n        `Links:createDynamicLink expects a 'DynamicLink' but got type ${typeof link}`\n      );\n    }\n\n    return await this.nativeModule.createDynamicLink(link.build());\n  }\n\n  /**\n   * Create short Dynamic Link from parameters\n   * @param parameters\n   * @returns {Promise.<String>}\n   */\n  async createShortDynamicLink(link: DynamicLink, type?: 'SHORT' | 'UNGUESSABLE'): Promise<string> {\n    if (!(link instanceof DynamicLink)) {\n      throw new Error(\n        `Links:createShortDynamicLink expects a 'DynamicLink' but got type ${typeof link}`\n      );\n    }\n\n    return await this.nativeModule.createShortDynamicLink(link.build(), type);\n  }\n\n  /**\n   * Returns the link that triggered application open\n   * @returns {Promise.<String>}\n   */\n  async getInitialLink(): Promise<string | undefined> {\n    return await this.nativeModule.getInitialLink();\n  }\n\n  /**\n   * Subscribe to dynamic links\n   * @param listener\n   * @returns {Function}\n   */\n  onLink(listener: (event: string) => any): () => any {\n    this.logger.info('Creating onLink listener');\n\n    SharedEventEmitter.addListener('onLink', listener);\n\n    return () => {\n      this.logger.info('Removing onLink listener');\n      SharedEventEmitter.removeListener('onLink', listener);\n    };\n  }\n}\n\nexport { default as DynamicLink } from './DynamicLink';\nexport { default as AnalyticsParameters } from './AnalyticsParameters';\nexport { default as AndroidParameters } from './AndroidParameters';\nexport { default as IOSParameters } from './IOSParameters';\nexport { default as ITunesParameters } from './ITunesParameters';\nexport { default as NavigationParameters } from './NavigationParameters';\nexport { default as SocialParameters } from './SocialParameters';\n"]}